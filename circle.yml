version: 2.1
orbs:
  cypress: cypress-io/cypress@1
executors:
  mac:
    macos:
      xcode: 10.2.0
workflows:
  build:
    macos:
    jobs:
      - cypress/install:
          pre-steps:
            - checkout
            - run:
                name: "Pull Submodules"
                command: |
                  git submodule init
                  git submodule update --remote
            - run:
                name: Build the REDCap image
                command: |
                    cd redcap-docker-compose/rdc
                    set -x
                    docker-compose up -d
      - cypress/run:
          wait-on: 'http://localhost:80'
          executor: mac